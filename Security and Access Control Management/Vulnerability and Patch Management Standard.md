# Vulnerability & Patch Management (VPM) Standard  
**AWS-Based Cryptocurrency Exchange Environment**

---

## 1. Purpose

This Vulnerability & Patch Management (VPM) Standard defines the minimum requirements to **identify, assess, prioritize, remediate, and verify** vulnerabilities across the cryptocurrency exchange’s AWS environment. It aims to reduce exploitable risk while respecting trading uptime, wallet security, and regulatory expectations (e.g., DORA).

**Framework alignment**
- **NIST CSF 2.0**: ID.AM, ID.RA, PR.PS, PR.IP, DE.CM, RS.MI  
- **ISO/IEC 27001:2022**: **A.8.8** (Management of technical vulnerabilities), A.8.9 (Configuration management), A.5.7 (Threat intelligence), A.5.20 (Supplier relationships), A.5.30 (ICT readiness for business continuity)

---

## 2. Scope

This standard applies to:
- All AWS accounts and regions
- Compute (EC2, ECS/EKS, Lambda), managed services, databases, network/security appliances, endpoints, and third-party hosted systems that process exchange data
- First- and third-party applications (including APIs, microservices, and CI/CD artifacts)
- Container images and base AMIs/golden images

---

## 3. Roles & Responsibilities

| Role | Responsibilities |
|------|------------------|
| Standard Owner | Owns this standard; approves updates and exceptions. |
| Security Risk & Governance (SRG) | Policy governance, risk acceptance workflow, reporting, audit support. |
| Attack Surface Reduction (ASR) | Tool ownership (e.g., Amazon Inspector, ECR/Image Builder integrations), scan orchestration, severity/priority guidance, zero‑day coordination. |
| System / Application Owners | Remediate within timelines; test/roll back; provide evidence of fixes or compensating controls. |
| DevOps / Platform | Patch pipelines (SSM Patch Manager, Image Builder), rollout orchestration, drift & compliance reporting. |
| Vendor Managers | Ensure hosting/SaaS vendors meet equivalent VPM requirements and deliver reports on request. |
| SOC / SecOps | Triage high‑risk findings; monitoring/detection for exploitation; escalation & incident linkage. |

---

## 4. Minimum Security Requirements (MSRs)

> **Severity & Prioritization:**  
> Unless specified, *severity* uses CVSS (base) plus **exploitability context** (e.g., public exploits, KEV listing), data sensitivity, exposure (internet‑facing), and asset criticality (trading engine, wallet/signing). Use this composite to set priority while **not exceeding** the maximum remediation timelines in §7.

### 4.1 Asset Inventory & Coverage (VPM‑01)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑01.1 | Maintain an authoritative inventory covering compute, containers, serverless, network appliances, third‑party hosted systems, and code artifacts. | ID.AM‑01/02 | A.8.8, A.8.9 | **AWS Config** resource inventory; **SSM Inventory**; CMDB exports; tag policy reports. |
| VPM‑01.2 | All in‑scope assets MUST be in continuous or scheduled vulnerability assessment. | ID.RA‑01 | A.8.8 | **Amazon Inspector** coverage dashboard; **Security Hub** controls status. |
| VPM‑01.3 | Classify assets by exposure (internet‑facing/core, internal prod, non‑prod, endpoints) to drive timelines in §7. | ID.AM‑02 | A.8.8 | Asset tags (`Exposure=Internet|Internal`), **Config** advanced queries, account/OU scoping. |

---

### 4.2 Vulnerability Identification (VPM‑02)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑02.1 | Enable **Amazon Inspector** for EC2, ECR images, Lambda function packages, and container workloads in all prod accounts. | ID.RA‑01 | A.8.8 | Inspector account‑wide enablement; org‑wide delegated admin; findings exports. |
| VPM‑02.2 | Enable **ECR enhanced image scanning** (on push and scheduled) for all registries. | ID.RA‑01 | A.8.8 | ECR repo settings; Inspector image scan findings. |
| VPM‑02.3 | For EC2/EKS nodes, collect OS/package inventories and patch state using **SSM Agent** + **SSM Patch Manager**. | ID.RA‑01 | A.8.9 | SSM compliance & patch baselines; State Manager associations. |
| VPM‑02.4 | For code and dependencies, use **SAST/CodeQL**, **SCA/Dependabot** (or equivalent) in CI; block merges on Critical/High. | DE.CM‑07 | A.8.8 | CI pipeline logs; PR checks; repo policy screenshots. |
| VPM‑02.5 | Perform authenticated internal scans (where applicable) of network devices and appliances; ensure safe scan profiles. | ID.RA‑01 | A.8.8 | Scanner configuration; authenticated scan proof; change records. |
| VPM‑02.6 | Subscribe to threat intel (e.g., KEV, vendor advisories) and elevate priority when active exploitation is confirmed. | ID.RA‑04 | A.5.7, A.8.8 | Threat intel runbooks; KEV watch list; JIRA tickets upgrading priority. |

---

### 4.3 Triage & Risk Treatment (VPM‑03)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑03.1 | Triage findings using CVSS + exploitability (public PoC/KEV), exposure, data sensitivity, and business criticality. | ID.RA‑04 | A.8.8 | Triage rubric; ticket fields; dashboards highlighting “KEV+Internet”. |
| VPM‑03.2 | Route Critical/High findings automatically to owning squads with due dates per §7. | PR.IP‑03 | A.8.8 | Issue automation rules; SLA timers; notifications. |
| VPM‑03.3 | Where patching is not immediately feasible, implement **documented compensating controls** (WAF rule, SG lock‑down, feature flag, config toggle, version pin, runtime policy) and set a short re‑review date. | PR.PS‑01/02 | A.8.8, A.8.9 | WAF/SG change records; Config diffs; Security Hub suppression w/ risk note. |
| VPM‑03.4 | If risk remains material, raise a **time‑boxed Risk Acceptance** approved by SRG. | ID.RA‑06 | A.8.8 | Approved risk acceptance record; expiry reminder. |

---

### 4.4 Patch Acquisition, Testing & Rollout (VPM‑04)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑04.1 | Patches must be sourced from **trusted channels** (vendor repos, signed artifacts, AWS managed baselines). | PR.PS‑02 | A.8.8 | Patch source lists; SSM baselines; signature verification logs. |
| VPM‑04.2 | Test patches in non‑prod or canary rings prior to prod; use automated health checks and rollback plans. | PR.IP‑06 | A.8.9 | Change tickets; pipeline stages; canary results. |
| VPM‑04.3 | Use **SSM Patch Manager** for EC2/EKS nodes; schedule maintenance windows per environment criticality. | PR.IP‑06 | A.8.8 | Patch groups/tags; Maintenance Window jobs; compliance reports. |
| VPM‑04.4 | **EC2 Image Builder** for hardened AMIs; **Golden images** must be clean of exploitable Critical/High/Medium before release. | PR.PS‑02 | A.8.8, A.8.9 | Image Builder pipelines; test results; Inspector scan pass. |
| VPM‑04.5 | **EKS**: keep control plane versions supported; patch managed node groups; enforce admission policies (e.g., block vulnerable images). | PR.PS‑02 | A.8.8, A.8.9 | EKS version plans; Gatekeeper/OPA policy evidence; node AMI updates. |
| VPM‑04.6 | **Lambda/Serverless**: track runtime EOL; update runtimes and third‑party libs; rebuild on new base images. | PR.PS‑02 | A.8.8 | Runtime versions inventory; CI rebuild logs; deployment records. |
| VPM‑04.7 | **Zero‑day / Out‑of‑cycle**: fast‑track testing and partial mitigations (WAF, SG, feature flag) while patching. | RS.MI‑01 | A.5.30, A.8.8 | Incident/major change records; emergency CAB notes. |
| VPM‑04.8 | Use **Kernel Live Patching** (where available) and phased rollouts to limit downtime for trading. | PR.IP‑06 | A.5.30 | Live‑patch config; rollout plan; health metrics. |

---

### 4.5 Verification, Monitoring & Evidence (VPM‑05)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑05.1 | Verify remediation by **rescanning** (Inspector/ECR/SAST) until finding state is “Closed/Fixed”. | DE.CM‑09 | A.8.8 | Before/after findings; scan job IDs. |
| VPM‑05.2 | Centralize compliance reporting (by OU/account, service, severity, SLA). | PR.IP‑11 | A.8.8 | **Security Hub** + **QuickSight** dashboards; **SSM Compliance** views. |
| VPM‑05.3 | Alert on SLA breaches and high‑risk deltas (e.g., new KEV affecting internet‑facing assets). | DE.CM‑08 | A.5.7 | CloudWatch/ EventBridge rules; ticket escalations. |
| VPM‑05.4 | Preserve evidence for **≥ 2 years** (findings, changes, approvals, tests) in write‑once storage. | PR.IP‑10 | A.5.33 | S3 bucket with Object Lock; lifecycle & retention policies. |

---

### 4.6 Third‑Party & Supplier Patch Management (VPM‑06)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑06.1 | Hosting/SaaS providers must maintain VPM at least equivalent to this standard. | GV.SC‑05 | A.5.20 | Contract clauses; vendor VPM reports; SOC 2/ISO certs. |
| VPM‑06.2 | Obtain and review vendor patch/vulnerability attestations for systems critical to custody/trading. | ID.RA‑06 | A.5.20 | Attestations; pen‑test summaries; remediation trackers. |

---

### 4.7 Crypto‑Specific Safeguards (VPM‑07)

| Control ID | Requirement | NIST CSF | ISO 27001 | AWS Evidence |
|---|---|---|---|---|
| VPM‑07.1 | **Wallet/signing** infrastructure: no standing admin access; patch through immutable images and controlled maintenance windows. | PR.PS‑02 | A.8.8 | Change records; Image Builder; role assumption logs. |
| VPM‑07.2 | **Hot wallet** services: prioritize kernel/OpenSSL/runtime patches; add network throttles/WAF rules during zero‑days. | RS.MI‑01 | A.5.30 | WAF rule deploys; SG changes; Inspector timelines. |
| VPM‑07.3 | **Cold wallet tooling**: patch on scheduled cycles; ensure strong compensating controls when offline. | PR.PS‑01 | A.8.8 | Offline maintenance logs; integrity attestations. |

---

## 5. Patch Cycles

| Cycle | Description | Examples |
|------|-------------|----------|
| **Zero‑Day** | Emergency changes for actively exploited or public PoC vulnerabilities with material risk. Invokes incident change path. | KEV‑listed RCE on internet‑facing service. |
| **Out‑of‑Cycle** | Urgent fixes outside BAU windows for Critical/High risk without active exploitation. | Critical vendor advisory without PoC. |
| **In‑Cycle** | Normal monthly/quarterly patch windows per environment. | Regular OS and middleware updates. |

---

## 6. Exceptions

- Use compensating controls where patching is temporarily infeasible; document, justify, and **time‑box**.  
- Development/non‑prod findings may be risk‑accepted if no data exposure and no promotion to prod is possible.  
- Legacy/EOL systems require isolation, strict network controls, and a decommission plan with target dates.

All exceptions require **SRG approval** with explicit expiry and review dates.

---

## 7. Maximum Remediation Timelines (SLAs)

> Apply the **earliest** of the applicable timelines (e.g., if both “internet‑facing” and “KEV” apply, use the stricter one). For code/dependencies, timelines start at **merge-to-default** or **release**; for infrastructure, at **vendor patch availability** or **finding detection** (whichever is earlier).

### 7.1 Compute & Installed Software (EC2, EKS nodes, RDS self‑managed engines, appliances)

| Severity | Internet‑Facing / Core Infrastructure | Internal Production | Internal Non‑Prod | End‑User Computing |
|---|---|---|---|---|
| **Critical** | **14 days** | **30 days** | 30 days | 30 days |
| **High** | **30 days** | Next patch cycle or 30 days | Next patch cycle or 30 days | Next patch cycle or 30 days |
| **Medium** | Next patch cycle or 90 days | Next patch cycle or 90 days | Next patch cycle or 90 days | Next patch cycle or 90 days |
| **Low** | Next available cycle | Next available cycle | Next available cycle | Next available cycle |

**Modifiers**
- **KEV / Active Exploitation**: treat as **Zero‑Day** (begin immediate mitigation; complete patching as soon as validated).  
- **Crown Jewels (trading engine, wallet/signing)**: target **50% of the above time** where feasible; otherwise add layered compensations (WAF/SG, feature flags).

### 7.2 Network & Security Appliances (firewalls, WAF gateways, VPN, IDS/IPS)

| Severity | Internet‑Facing | Internal Production | Internal Non‑Prod |
|---|---|---|---|
| **Critical** | **14 days** | **30 days** | 30 days |
| **High** | **30 days** | Next cycle or **90 days** | Next cycle or **90 days** |
| **Medium** | Next cycle or **90 days** | Next cycle or **90 days** | Next cycle or **90 days** |
| **Low** | Next available cycle | Next available cycle | Next available cycle |

### 7.3 Containers & Images

| Scope | Critical | High | Medium | Low |
|---|---|---|---|---|
| **ECR Images (prod)** | 14 days | 30 days | 90 days | Next cycle |
| **Running Pods (prod)** | Roll new image within 30 days (or sooner if KEV) | 30 days | 90 days | Next cycle |
| **Base Images/Golden AMIs** | Must be clean (no exploitable Critical/High/Medium) **before release to prod** | — | — | — |

### 7.4 Code, Libraries & CI Artifacts

| Severity | Production |
|---|---|
| **Critical** | **14 days** |
| **High** | **30 days** |
| **Medium** | **90 days** |
| **Low** | Next cycle |

**Notes**
- Use **SCA** reachability/context (where available) to prioritize, but do **not** exceed the maximums above.
- Pre‑existing tech debt requires a **remediation plan** with milestones and risk acceptance until cleared.

---

## 8. Monitoring, Reporting & Evidence

- **Dashboards:** Security Hub/Inspector/SSM compliance, grouped by OU/account/service.  
- **Alerts:** SLA breach, new KEV impacting internet‑facing assets, spike in Critical/High backlog.  
- **Evidence Retention:** Minimum **2 years** in **S3 with Object Lock**; include findings, approvals, test results, change records, and rescans.

---

## 9. Compliance & Review

- Reviewed **at least every 24 months** or after major AWS/service or regulatory changes.  
- Exceptions are approved by **SRG** and tracked to expiry.  
- Evidence must support **internal audit** and **regulatory** reviews (e.g., DORA, CBI).

---

## 10. Quick AWS-to-Control Reference (Auditor Cheat Sheet)

- **Discovery & Scanning:** Amazon **Inspector**, **ECR Enhanced Scanning**, **Config**, **SSM Inventory**  
- **Patching:** **SSM Patch Manager**, **Maintenance Windows**, **EC2 Image Builder**, **Kernel Live Patching**  
- **Kubernetes:** **EKS** versioning, **managed node groups**, **OPA/Gatekeeper**/admission policies  
- **Serverless:** Runtime tracking, CI rebuilds, dependency updating  
- **Monitoring & Evidence:** **Security Hub**, **CloudWatch**, **EventBridge**, **QuickSight**, **S3 Object Lock**, **CloudTrail**

---

## 11. Interview Summary (Optional to keep in README)

- Risk‑based but **deadline‑driven** SLAs  
- **Zero‑standing privilege** for wallet/signing maintenance; immutable images; short windows  
- Clear **AWS evidence** per control for audits  
- Designed to meet **DORA** resilience expectations while operating a live exchange

``
